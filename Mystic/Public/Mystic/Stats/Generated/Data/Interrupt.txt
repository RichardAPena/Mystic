// Punishing Fury
new entry "Interrupt_Mystic_PunishingFury"
type "InterruptData"
data "DisplayName" "h9e949f54g1892g4f19g86d8gd20bdf2fd643"
data "Description" "h02f249deg73f6g4362g8633g71803017fe51"
data "Icon" "Action_GoadingAttack_Melee"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
data "Conditions" "not Self(context.Source,context.Observer) and Ally(context.Target, context.Observer) and Enemy(context.Source, context.Observer) and IsAbleToReact(context.Observer) and IsMeleeAttack() and not DistanceToEntityGreaterThan(2, context.ObserverPosition, context.Source) and not AnyEntityIsItem() and HasLastAttackTriggered() and HasStatus('MYSTIC_PUNISHING_FURY', context.Source)"
data "Properties" "UseAttack(OBSERVER_SOURCE)"
data "Cost" "ReactionActionPoint:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasAnyStatus({'SG_Polymorph','SG_Blinded'}) or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

// Aura of Victory (Rallying Cry/Triumph)
new entry "Interrupt_Mystic_AuraOfVictory"
type "InterruptData"
data "DisplayName" "h217c8d85gd7ebg4ddcg901agd58751efd008"
data "Description" "he9fd8855g276ag4df7gaa45gaef25f12f283"
data "Icon" "Action_InspiringLeader"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
data "Conditions" "HasHPLessThan(1) and Enemy() and Character()"
data "Properties" "UseSpell(OBSERVER_OBSERVER,Shout_Mystic_Triumph,true,true,true)"
data "InterruptDefaultValue" "Enabled"

new entry "Interrupt_Mystic_AuraOfVictory_2"
type "InterruptData"
using "Interrupt_Mystic_AuraOfVictory"
data "Properties" "UseSpell(OBSERVER_OBSERVER,Shout_Mystic_Triumph_2,true,true,true)"

new entry "Interrupt_Mystic_AuraOfVictory_3"
type "InterruptData"
using "Interrupt_Mystic_AuraOfVictory"
data "Properties" "UseSpell(OBSERVER_OBSERVER,Shout_Mystic_Triumph_3,true,true,true)"

new entry "Interrupt_Mystic_AuraOfVictory_4"
type "InterruptData"
using "Interrupt_Mystic_AuraOfVictory"
data "Properties" "UseSpell(OBSERVER_OBSERVER,Shout_Mystic_Triumph_4,true,true,true)"

new entry "Interrupt_Mystic_AuraOfVictory_5"
type "InterruptData"
using "Interrupt_Mystic_AuraOfVictory"
data "Properties" "UseSpell(OBSERVER_OBSERVER,Shout_Mystic_Triumph_5,true,true,true)"

new entry "Interrupt_Mystic_AuraOfVictory_6"
type "InterruptData"
using "Interrupt_Mystic_AuraOfVictory"
data "Properties" "UseSpell(OBSERVER_OBSERVER,Shout_Mystic_Triumph_6,true,true,true)"

new entry "Interrupt_Mystic_AuraOfVictory_7"
type "InterruptData"
using "Interrupt_Mystic_AuraOfVictory"
data "Properties" "UseSpell(OBSERVER_OBSERVER,Shout_Mystic_Triumph_7,true,true,true)"

// Adaptive Shield
new entry "Interrupt_Mystic_AdaptiveShield"
type "InterruptData"
data "DisplayName" "ha4113923g6596g4aa4ga10fg5d07f8d8abe7"
data "Description" "h6953cb97gffa3g4419gb10bg7aba9f9e8923"
data "Icon" "PassiveFeature_AbsorbElements"
data "InterruptContext" "OnPreDamage"
data "InterruptContextScope" "Self"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and (SpellDamageTypeIs(DamageType.Acid) or SpellDamageTypeIs(DamageType.Cold) or SpellDamageTypeIs(DamageType.Fire) or SpellDamageTypeIs(DamageType.Lightning) or SpellDamageTypeIs(DamageType.Thunder)) and not AnyEntityIsItem()"
data "Properties" "SetDamageResistance(Acid);SetDamageResistance(Cold);SetDamageResistance(Fire);SetDamageResistance(Lightning);SetDamageResistance(Thunder);IF(SpellDamageTypeIs(DamageType.Acid)):ApplyStatus(OBSERVER_TARGET, MYSTIC_ADAPTIVE_SHIELD_ACID,100,1);IF(SpellDamageTypeIs(DamageType.Cold)):ApplyStatus(OBSERVER_TARGET, MYSTIC_ADAPTIVE_SHIELD_COLD,100,1);IF(SpellDamageTypeIs(DamageType.Fire)):ApplyStatus(OBSERVER_TARGET, MYSTIC_ADAPTIVE_SHIELD_FIRE,100,1);IF(SpellDamageTypeIs(DamageType.Lightning)):ApplyStatus(OBSERVER_TARGET, MYSTIC_ADAPTIVE_SHIELD_LIGHTNING,100,1);IF(SpellDamageTypeIs(DamageType.Thunder)):ApplyStatus(OBSERVER_TARGET, MYSTIC_ADAPTIVE_SHIELD_THUNDER,100,1);"
data "Cost" "ReactionActionPoint:1;PsiPointsResource:3;PsiLimitResource:1:3"
data "EnableCondition" "not HasStatus('SG_Polymorph')"
data "EnableContext" "OnActionResourcesChanged"
data "Container" "YesNoDecision"
data "InterruptDefaultValue" "Ask;Enabled"

// Psychic Backlash
new entry "Interrupt_Mystic_PsychicBacklash"
type "InterruptData"
data "DisplayName" ""
data "Description" ""
data "Icon" ""
data "InterruptContext" ""
data "InterruptContextScope" ""
data "Container" ""
data "Conditions" ""
data "Properties" ""
data "Cost" ""
data "InterruptDefaultValue" ""

// Psychic Parry
new entry "Interrupt_Mystic_PsychicParry"
type "InterruptData"
data "DisplayName" ""
data "Description" ""
data "Icon" ""
data "InterruptContext" ""
data "InterruptContextScope" ""
data "Container" ""
data "Conditions" ""
data "Properties" ""
data "Cost" ""
data "InterruptDefaultValue" ""

// All-Around Sight
new entry "Interrupt_Mystic_AllAroundSight"
type "InterruptData"
data "DisplayName" ""
data "Description" ""
data "Icon" ""
data "InterruptContext" ""
data "InterruptContextScope" ""
data "Container" ""
data "Conditions" ""
data "Properties" ""
data "Cost" ""
data "InterruptDefaultValue" ""

// Knock Back
// DEPRECATED
// new entry "Interrupt_Mystic_KnockBack"
// type "InterruptData"
// data "DisplayName" "h64861ffdge092g4be5gae41g02d96367cb93"
// data "Description" "hafa0ff17g5d7fg4454gb0c4g5eee7b446f19"
// data "DescriptionParams" "Distance(9)"
// data "Icon" "Action_Monk_FistOfUnbrokenAir"
// data "InterruptContext" "OnCastHit"
// data "InterruptContextScope" "Nearby"
// data "Container" "YesNoDecision"
// data "Conditions" "Self(context.Source,context.Observer) and IsMeleeAttack() and not IsKillingBlow() and IsHit() and Character() and not AnyEntityIsItem()"
// // TODO: CAST THE ACTUAL SPELL, THERE NEEDS TO BE A SAVING THROW
// // data "Roll" "not SavingThrow(Ability.Strength, SourceSpellDC())"
// // data "Roll" "not SavingThrow(Ability.Wisdom, SourceSpellDC(14,context.Observer,Ability.Intelligence),,false,context.Source)"
// // data "Success" "Force(9)"
// // data "Properties" "Force(9);DealDamage(1,Radiant)"
// data "Properties" "UseSpell(OBSERVER_TARGET,Target_Mystic_KnockBack_Interrupt,true,true,true)"
// data "Cost" "ReactionActionPoint:1;PsiPointsResource:2"
// data "InterruptDefaultValue" "Ask;Enabled"
// // data "EnableCondition" "HasActionResource('Interrupt_PsionicStrike', 1, 0, false, false, context.Source) and (not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER'))"
// // data "EnableContext" "OnActionResourcesChanged"
// // data "Properties" "AdjustRoll(-1d4);IF(not Self(context.Target,context.Observer) and HasInterruptedAttack()):UseSpell(OBSERVER_SOURCE,Target_BendLuck_Interrupt_Negative,true,true,true);IF(not Self(context.Target,context.Observer) and HasInterruptedSavingThrow()):UseSpell(OBSERVER_TARGET,Target_BendLuck_Interrupt_Negative,true,true,true)"



// Acid Spray
// TODO: not working?
new entry "Interrupt_Mystic_AcidSpray"
type "InterruptData"
data "DisplayName" "hc7b88abbg0bf9g468aga89fgc539b6688cac"
data "Description" "h0d03313eg42eeg4e62g99a8gd78ebb954dfe"
data "DescriptionParams" "DealDamage(2d6,Acid);Distance(3)"
data "Icon" "Spell_Conjuration_AcidSplash"
data "InterruptContext" "OnPreDamage"
data "InterruptContextScope" "Self"
// data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and (SpellDamageTypeIs(DamageType.Piercing) or SpellDamageTypeIs(DamageType.Slashing)) and not AnyEntityIsItem()"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and not AnyEntityIsItem()"

data "Properties" "UseSpell(OBSERVER_OBSERVER,Shout_Mystic_AcidSpray_Interrupt,true,true,true)"
data "Cost" "ReactionActionPoint:1;PsiPointsResource:2"
data "EnableCondition" "not HasStatus('SG_Polymorph')"
data "EnableContext" "OnActionResourcesChanged"
data "Container" "YesNoDecision"
data "InterruptDefaultValue" "Ask;Enabled"

// Sudden Shift
new entry "Interrupt_Mystic_SuddenShift"
type "InterruptData"
data "DisplayName" "h3a999e58g5ceeg4ac1ga20aga6efd47b87f3"
data "Description" "h9de05705gcb47g47dcga990g7ede44af0407"
data "Icon" "Spell_Illusion_MirrorImage"
data "InterruptContext" "OnPostRoll;OnPreDamage"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and not AnyEntityIsItem()"
data "Properties" "SetRoll(0);ApplyStatus(OBSERVER_OBSERVER,DISENGAGE,100,1);AdjustRoll(-99)"
data "Cost" "ReactionActionPoint:1;PsiPointsResource:5;PsiLimitResource:1:5"
data "InterruptDefaultValue" "Ask;Enabled"

// Iron Hide
new entry "Interrupt_Mystic_IronHide"
type "InterruptData"
data "DisplayName" "h3a5789efg2457g4ca8ga0f8gce3100d94894"
data "Description" "hc17c8044g089bg4c41g825dg242f478d8782"
data "Icon" "PassiveFeature_HeavilyArmored"
data "InterruptContext" "OnPostRoll;OnPreDamage"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Cost" "ReactionActionPoint:1;PsiPointsResource:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and ((HasInterruptedAttack() and IsFlatValueInterruptInteresting(3, context.Source))) and not AnyEntityIsItem() and not HasStatus('MYSTIC_IRON_HIDE',context.Observer)"
data "Properties" "IF(HasInterruptedAttack()):AdjustRoll(-3);ApplyStatus(OBSERVER_OBSERVER,MYSTIC_IRON_HIDE,100,1)"

// Seeking Missile
new entry "Interrupt_Mystic_SeekingMissile"
type "InterruptData"
data "DisplayName" ""
data "Description" ""
data "Icon" ""
data "InterruptContext" ""
data "InterruptContextScope" ""
data "Container" ""
data "Conditions" ""
data "Properties" ""
data "Cost" ""
data "InterruptDefaultValue" ""

// Cloak of Air
new entry "Interrupt_Mystic_CloakOfAir"
type "InterruptData"
data "DisplayName" "h5d42f170g2a58g4e88ga06aga5a39b850cb0"
data "Description" "h93c76e27ge89dg4ae4gbd44gdfddde815d75"
data "DescriptionParams" "DealDamage(1d6,Slashing)"
data "Icon" "Spell_Transmutation_Blink"
data "InterruptContext" "OnPostRoll"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
data "Cost" ""
data "InterruptDefaultValue" "Enabled"
data "EnableCondition" "not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied"
// data "Conditions" "Self(context.Target,context.Observer) and IsMeleeAttack() and (IsCriticalMiss() or IsMiss()) and not AnyEntityIsItem()"
data "Conditions" "Self(context.Target,context.Observer) and not AnyEntityIsItem()"
// data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target,context.Observer) and ((HasInterruptedAttack() and IsFlatValueInterruptInteresting(3, context.Source))) and not AnyEntityIsItem() and not HasStatus('MYSTIC_IRON_HIDE',context.Observer)"
// data "Properties" "IF(HasInterruptedAttack()):AdjustRoll(-3);ApplyStatus(OBSERVER_OBSERVER,MYSTIC_IRON_HIDE,100,1)"
data "Properties" "DealDamage(OBSERVER_SOURCE,1d6,Slashing)"


// Psionic Strike
new entry "Interrupt_Mystic_PsionicStrike"
type "InterruptData"
data "DisplayName" "h2ae84d46g9f37g45a5g988bg8b08fff62394"
data "Description" "hf729263eg37dcg43fbg923cg24cc642f6773"
data "DescriptionParams" "DealDamage(1d8,Psychic)"
data "Icon" "Action_DivineStrike_Melee"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Conditions" "Self(context.Source,context.Observer) and IsWeaponAttack() and not IsCritical() and not IsKillingBlow() and IsHit() and not IsDivineStrike() and Character() and not AnyEntityIsItem()"
data "Properties" "DealDamage(1d8,Psychic)"
data "Cost" "Interrupt_PsionicStrike:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "HasActionResource('Interrupt_PsionicStrike', 1, 0, false, false, context.Source) and (not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER'))"
data "EnableContext" "OnActionResourcesChanged"

new entry "Interrupt_Mystic_PsionicStrike_Critical"
type "InterruptData"
using "Interrupt_Mystic_PsionicStrike"
data "DisplayName" "hd3ca609cg1645g4f9fgaed4g5b36b263fa89"
data "Conditions" "Self(context.Source,context.Observer) and IsWeaponAttack() and IsCritical() and not IsKillingBlow() and IsHit() and not IsDivineStrike() and Character() and not AnyEntityIsItem()"

// Psionic Surge

// Surge of Health

// Look at this it's from UNcanny Dodge from Rouge
// It's ni passives
// DamageReduction(All,Half,)
// new entry "UncannyDodge"
// type "PassiveData"
// data "DisplayName" "h488725bbg091fg45d3g861eg92471d21a857;2"
// data "Description" "h834e2af0g618ag44c4gbc44gcde3210f48c0;2"
// data "Icon" "PassiveFeature_UncannyDodge"
// data "EnabledConditions" "HasActionResource('ReactionActionPoint', 1, 0, false)"
// data "EnabledContext" "OnDamaged;OnTurn;OnStatusApplied"
// data "Properties" "ToggledDefaultOn;ToggledDefaultAddToHotbar;IsToggled"
// data "Boosts" "DamageReduction(All,Half,)"
// data "StatsFunctorContext" "OnDamaged"
// data "StatsFunctors" "UseActionResource(ReactionActionPoint,1,0);ApplyStatus(UNCANNYDODGE_HELPER,100,1)"
// figure it out i believe in u

new entry "Interrupt_Mystic_SurgeOfHealth"
type "InterruptData"
data "DisplayName" "h56cb35d0g56f3g4098g8d58gbdab90b41a46"
data "Description" "h29c97f6dg93efg4497g9f86gdcf3a6ecaa0e"
data "Icon" "Action_Barbarian_MagicAwareness"
data "InterruptContext" "OnPreDamage"
data "InterruptContextScope" "Nearby"
data "Container" "YesNoDecision"
data "Conditions" "IsAbleToReact(context.Observer) and Self(context.Target,context.Observer)"
// TODO
// data "Properties" "AdjustRoll(OBSERVER_OBSERVER,-(LevelMapValue(SuperiorityDie)+DexterityModifier))"
// What I need is a way to access the incoming damage, and reduce that by x/2
// data "Properties" "AdjustRoll(OBSERVER_OBSERVER, -(IntelligenceModifier*2))"
// Bah we'll just do this for now
data "Properties" "SetDamageResistance(Bludgeoning);SetDamageResistance(Piercing);SetDamageResistance(Slashing);SetDamageResistance(Acid);SetDamageResistance(Cold);SetDamageResistance(Fire);SetDamageResistance(Force);SetDamageResistance(Lightning);SetDamageResistance(Necrotic);SetDamageResistance(Poison);SetDamageResistance(Psychic);SetDamageResistance(Radiant);SetDamageResistance(Thunder);"
data "Cost" "ReactionActionPoint:1;Interrupt_SurgeOfHealth:1"
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "not HasAnyStatus({'SG_Polymorph'}) or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied"

// Memory of One Thousand Steps
new entry "Interrupt_Mystic_MemoryOfOneThousandSteps"
